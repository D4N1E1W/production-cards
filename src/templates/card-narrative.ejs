<div class="card">
  <div class="header">
    <div class="title">
      <span style="font-size: 9pt; color: var(--accent); font-weight: 800; margin-right: 2mm;">#<%= beat.beatId %></span>
      <%= beat.scene || 'Untitled Scene' %> &mdash; <%= beat.logline %>
    </div>
    <div class="meta">
      <span class="status <%= beat.status.toLowerCase() %>">&#127916; <%= beat.status %></span>
      <span style="background: var(--surface); padding: 1mm 2mm; border-radius: var(--radius-sm); font-weight: 600;">&#9201; <%= beat.estMinutes || 0 %>m</span>
      <span style="background: var(--surface); padding: 1mm 2mm; border-radius: var(--radius-sm); font-weight: 600;">&#128249; <span class="ok"><%= beat.shotProgress.done %></span>/<%= beat.shotProgress.total %></span>
    </div>
  </div>

  <div class="pills">
    <% if (beat.location) { %><span class="pill">&#128205; <%= beat.location %></span><% } %>
    <% if (beat.cast && beat.cast.length) { %><span class="pill">&#127917; <%= beat.cast.join(', ') %></span><% } %>
    <% if (beat.shootDay) { %><span class="pill">&#128197; Day <%= beat.shootDay %></span><% } %>
    <% if (beat.weather) { %><span class="pill">&#127780; <%= beat.weather %></span><% } %>
  </div>

  <div class="progress small">
    <div>Checklist: <%= (beat.checklist || []).filter(c=>c.done).length %>/<%= (beat.checklist || []).length %></div>
    <% if (beat.risks && beat.risks.length) { %>
      <div>Risks: <%= beat.risks.map(r => (r.level ? r.level+': ' : '') + r.note).join(' • ') %></div>
    <% } %>
  </div>

  <div class="grid">
    <div>
      <div class="section-title">&#128214; Narrative</div>
      <div class="kv">
        <div>&#127919; Intent</div><div><%= beat.intent || 'Define character motivation' %></div>
        <div>&#9889; Stakes</div><div><%= beat.stakes || 'What\'s at risk' %></div>
        <div>&#127914; Outcome</div><div><%= beat.outcome || 'Scene resolution' %></div>
        <% if (beat.emotion) { %><div>&#128173; Emotion</div><div><%= beat.emotion %></div><% } %>
      </div>
      <hr/>
      <div class="section-title">&#9989; Production Notes</div>
      <div class="list">
        <% (beat.checklist || []).forEach(function(item){ %>
          <div class="small" style="display: flex; align-items: center; gap: 1mm; margin-bottom: 1mm;">
            <span style="color: <%= item.done ? 'var(--success)' : 'var(--muted)' %>; font-weight: bold;"><%= item.done ? '&#10003;' : '&#9675;' %></span>
            <span style="<%= item.done ? 'text-decoration: line-through; opacity: 0.7;' : '' %>"><%= item.label %></span>
          </div>
        <% }) %>
        <% if (!beat.checklist || !beat.checklist.length) { %>
          <div class="small" style="color: var(--muted); font-style: italic;">&#128221; Add production checklist items</div>
        <% } %>
      </div>
    </div>

    <div>
      <div class="section-title">&#127909; Technical</div>
      <div class="kv">
        <div>&#128208; Coverage</div><div><%= (beat.camera && beat.camera.coverage) || 'Standard coverage' %></div>
        <div>&#128269; Lenses</div><div><%= (beat.camera && beat.camera.lenses && beat.camera.lenses.join(', ')) || 'Standard kit' %></div>
        <div>&#127916; Movement</div><div><%= (beat.camera && beat.camera.move) || 'Static/handheld' %></div>
        <div>&#127908; Audio</div><div><%= (beat.sound && beat.sound.mics && beat.sound.mics.join(', ')) || 'Boom + lavs' %></div>
        <% if (beat.lighting) { %><div>&#128161; Lighting</div><div><%= beat.lighting %></div><% } %>
      </div>
      <hr/>
      <div class="section-title">&#127919; Shot List</div>
      <div class="list">
        <% (beat.shots || []).forEach(function(s){ %>
          <div class="small" style="background: var(--surface); padding: 1.5mm; border-radius: var(--radius-sm); margin-bottom: 1mm; border-left: 3px solid <%= s.status === 'done' ? 'var(--success)' : s.status === 'in-progress' ? 'var(--warning)' : 'var(--muted)' %>;">
            <strong style="color: var(--accent);"><%= s.id %></strong> — <%= s.type || 'Standard' %> • <%= s.lens ? s.lens + 'mm' : '35mm' %> • <%= s.move || 'Static' %><br>
            <span style="font-size: 7.5pt; color: var(--muted);">Status: <%= s.status %> • Est: <%= s.est || 0 %>m</span>
          </div>
        <% }) %>
        <% if (!beat.shots || !beat.shots.length) { %>
          <div class="small" style="color: var(--muted); font-style: italic; text-align: center; padding: 2mm;">&#128203; Shot list to be determined</div>
        <% } %>
      </div>
    </div>
  </div>

  <div class="footer">
    <div class="links">
      <% if (beat.links && beat.links.script) { %><a class="link" href="<%= beat.links.script %>">Script</a><% } %>
      <% if (beat.links && beat.links.boards) { %><a class="link" href="<%= beat.links.boards %>">Boards</a><% } %>
      <% if (beat.links && beat.links.drive) { %><a class="link" href="<%= beat.links.drive %>">Drive</a><% } %>
      <% if (beat.links && beat.links.floorplan) { %><a class="link" href="<%= beat.links.floorplan %>">Floorplan</a><% } %>
    </div>
    <% if (beat.qrDataUrl) { %>
      <img class="qr" src="<%= beat.qrDataUrl %>" alt="QR"/>
    <% } %>
  </div>
</div>